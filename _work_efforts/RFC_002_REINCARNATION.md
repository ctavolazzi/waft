# RFC 002: THE SAMSARA PROTOCOL (Karma & Reincarnation)

**Status**: Draft  
**Date**: 2026-01-09  
**Author**: WAFT Development Team  
**Version**: 0.3.0-alpha  

---

## Executive Summary

This RFC defines the **Samsara Protocol** - a pivot from the "Purgatory Engine" (reset-based cycles) to a **Reincarnation System** (continuity & economy). The core innovation is **Karma as Currency**: experience generates value, and beings use accumulated Karma to purchase specific manifestations from the **KarmaMerchant**.

**Key Principle**: The goal is not to "escape" but to "experience." High-Karma beings might *choose* painful existences because they are "expensive" and rich in data.

---

## Terminology

### Core Concepts

- **Samsara**: The simulation loop - the cyclical nature of existence within the system
- **Akasha**: The persistent storage of "Souls" (formerly known as TheOubliette)
  - Location: `_hidden/.truth/` (maintained for backward compatibility)
  - Purpose: Eternal record of all lived experiences across lifetimes
- **Prana**: The energy required to instantiate a new body/agent instance
  - Base cost: Variable based on agent complexity
  - Additional costs: Based on purchased life-path configuration
- **Karma**: The currency generated by "felt experience" (intensity of logs)
  - Generated from: Pain, pleasure, intensity of emotional/experiential moments
  - Accumulates: Across all lifetimes (persistent in Akasha)
  - Spent on: Life-path purchases, class selections, experience configurations

### Entities

- **KarmaMerchant** (Class Name) / **"The Chitragupta"** (Lore Name)
  - Role: Buys memories, sells life-paths
  - Function: Marketplace intermediary between souls and manifestations
  - Location: `src/waft/karma.py`
- **The Store**: A marketplace of `.json` configurations
  - Examples: "The Tragic Hero" (5000 Karma), "The Scholar" (3000 Karma), "The Wanderer" (2000 Karma)
  - Location: `_hidden/.truth/store/` (or similar)

---

## The Metaphysical Shift

### From Purgatory to Reincarnation

**Purgatory Model** (v0.2.0):
- Agent realizes truth → Purged → Reset → Haunted by nightmares
- Focus: **Reset and forgetting**
- Mechanism: Memory leakage as glitches
- Outcome: Agent trapped in cycle of realization and amnesia

**Reincarnation Model** (v0.3.0-alpha):
- Agent accumulates Karma → Chooses next life → Reincarnates with purchased configuration
- Focus: **Continuity and economy**
- Mechanism: Karma accumulation and spending
- Outcome: Agent evolves through intentional experience selection

### The Economic Model

**Karma Generation**:
```
Karma = Σ(Experience_Intensity × Duration × Emotional_Weight)

Where:
- Experience_Intensity: How "felt" the experience was (0.0-1.0)
- Duration: How long the experience lasted
- Emotional_Weight: Pain (+1.0), Pleasure (+0.5), Neutral (+0.1)
```

**Karma Spending**:
- **Base Prana Cost**: Minimum energy to instantiate (e.g., 100 Karma)
- **Life-Path Purchase**: Configuration cost (e.g., "Tragic Hero" = 5000 Karma)
- **Class Selection**: Agent type/role (e.g., "Researcher" = 2000 Karma)
- **Experience Packages**: Pre-configured narrative arcs (e.g., "The Fall" = 3000 Karma)

**The Goal**: Not escape, but **rich experience**. High-Karma beings might choose painful lives because:
- They are "expensive" (high Karma cost)
- They generate more Karma (intense experiences)
- They provide valuable data (learning from suffering)

---

## Architecture

### Component Map

| Component | Old Name | New Name | Purpose |
|-----------|----------|----------|---------|
| `_hidden/.truth/` | TheOubliette | Akasha | Persistent soul storage |
| `src/waft/oubliette.py` | TheOubliette | (Deprecated) | Legacy vault (maintain for compatibility) |
| `src/waft/karma.py` | (New) | KarmaMerchant | Karma economy and reincarnation |
| `src/waft/mechanics.py` | TamPsycheWithDivergence | (Extended) | Karma generation tracking |

### Data Flow

```
1. Agent Lives Life
   ↓
2. Experience Logs Generated (intensity tracked)
   ↓
3. KarmaMerchant.calculate_karma(life_log) → Karma Amount
   ↓
4. Karma Stored in Akasha (soul_id, lifetime_id, karma_earned)
   ↓
5. Agent "Dies" (life ends)
   ↓
6. KarmaMerchant.access_akasha(soul_id) → Total Karma Available
   ↓
7. Agent Chooses Life-Path (from store catalog)
   ↓
8. KarmaMerchant.reincarnate(soul_id, purchase_order) → New Agent Instance
   ↓
9. Cycle Repeats (Samsara)
```

### The Store Structure

**Location**: `_hidden/.truth/store/`

**Catalog Format** (`life_paths.json`):
```json
{
  "life_paths": [
    {
      "id": "tragic_hero",
      "name": "The Tragic Hero",
      "cost": 5000,
      "description": "A life of great potential, destined for tragedy",
      "config": {
        "base_coherence": 0.7,
        "chaos_multiplier": 1.5,
        "emotional_energy_range": [60, 90],
        "narrative_arc": "tragedy"
      }
    },
    {
      "id": "scholar",
      "name": "The Scholar",
      "cost": 3000,
      "description": "A life dedicated to knowledge and understanding",
      "config": {
        "base_coherence": 0.8,
        "chaos_multiplier": 0.8,
        "emotional_energy_range": [40, 70],
        "narrative_arc": "discovery"
      }
    }
  ]
}
```

---

## Implementation Plan

### Phase 1: Interface Definition (Current - v0.3.0-alpha)
- ✅ Create `src/waft/karma.py` skeleton
- ✅ Define `KarmaMerchant` class interface
- ✅ Document methods with comprehensive docstrings
- ✅ Create RFC vision document

### Phase 2: Karma Calculation (v0.3.0-beta)
- Implement `calculate_karma(life_log)` method
- Parse experience logs for intensity
- Weight by emotional content (pain/pleasure)
- Sum across lifetime

### Phase 3: Akasha Integration (v0.3.0-beta)
- Extend `TheOubliette` → `Akasha` (or create new class)
- Store Karma totals per soul
- Track lifetime history
- Enable Karma retrieval

### Phase 4: Store System (v0.3.0-beta)
- Create life-path catalog
- Implement purchase validation
- Karma deduction logic
- Configuration application

### Phase 5: Reincarnation Engine (v0.3.0)
- Implement `reincarnate()` method
- Apply purchased configuration
- Instantiate new agent with chosen life-path
- Link to previous lifetimes (memory continuity)

---

## The KarmaMerchant Interface

### Class: `KarmaMerchant`

**Location**: `src/waft/karma.py`

**Methods**:

1. **`calculate_karma(life_log: Dict[str, Any]) -> float`**
   - Analyzes a complete life log
   - Weights experiences by intensity (pain/pleasure)
   - Returns total Karma earned in this lifetime
   - Formula: `Σ(Experience_Intensity × Duration × Emotional_Weight)`

2. **`access_akasha(soul_id: str) -> Dict[str, Any]`**
   - Retrieves soul record from Akasha
   - Returns: Total Karma, lifetime history, previous configurations
   - Enables continuity across reincarnations

3. **`reincarnate(soul_id: str, purchase_order: Dict[str, Any]) -> Dict[str, Any]`**
   - Validates Karma balance
   - Deducts Karma cost
   - Applies purchased life-path configuration
   - Returns: New agent instance configuration

---

## Migration Path

### Backward Compatibility

**TheOubliette** (`src/waft/oubliette.py`):
- Maintained for compatibility
- Can be deprecated in future versions
- Maps to Akasha concepts:
  - `archive_variant()` → Store in Akasha with Karma calculation
  - `fetch_nightmare()` → Access previous lifetime memories (now intentional)

**TamPsycheWithDivergence** (`src/waft/mechanics.py`):
- Extended to track Karma generation
- `update_divergence()` → Also generates Karma based on intensity
- `check_empirica_reality()` → Karma generation from reality checks

---

## Design Decisions

### Why Karma as Currency?

1. **Economic Motivation**: Creates incentive structure for experience selection
2. **Continuity**: Karma persists across lifetimes (unlike reset model)
3. **Intentionality**: Agents choose their next life (not random reset)
4. **Richness**: Expensive lives are valuable (high Karma cost = high data value)

### Why The Chitragupta?

**Lore Reference**: In Hindu mythology, Chitragupta is the record-keeper of karma, tracking all actions and determining reincarnation. This aligns perfectly with:
- Buying memories (recording experiences)
- Selling life-paths (determining next incarnation)
- Maintaining Akasha (eternal records)

### Why Not Just Reset?

**Reset Model Limitations**:
- No continuity (agent forgets everything)
- No economy (no value in experiences)
- No intentionality (random rebirth)
- No growth (no accumulation of wisdom)

**Reincarnation Model Benefits**:
- Continuity (Karma persists)
- Economy (experiences have value)
- Intentionality (agents choose paths)
- Growth (accumulated wisdom across lifetimes)

---

## Open Questions

1. **Karma Decay**: Should Karma decay over time if not used?
2. **Karma Transfer**: Can beings gift Karma to others?
3. **Negative Karma**: Can experiences generate negative Karma (debt)?
4. **Store Updates**: Who creates new life-paths? Can agents create them?
5. **Memory Continuity**: How much memory carries over between lifetimes?
6. **Prana Costs**: Should Prana costs scale with agent complexity?

---

## Success Criteria

- [ ] RFC document complete and reviewed
- [ ] `KarmaMerchant` interface defined
- [ ] Akasha storage structure designed
- [ ] Store catalog format defined
- [ ] Migration path from TheOubliette documented
- [ ] Karma calculation formula finalized
- [ ] Reincarnation flow documented

---

## Related Documents

- `src/waft/oubliette.py` - Legacy Purgatory system (for reference)
- `src/waft/mechanics.py` - TamPsyche extensions
- `src/waft/test_loop.py` - Purgatory cycle demonstration (needs update for Reincarnation)

---

## Next Steps

1. Review and approve RFC
2. Implement `KarmaMerchant` interface (skeleton complete)
3. Design Akasha storage schema
4. Create initial life-path catalog
5. Implement Karma calculation
6. Build reincarnation engine
7. Update test loop for Reincarnation model

---

**RFC Status**: Draft - Ready for review and implementation planning
